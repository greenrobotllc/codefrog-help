<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  {% seo %}
  {% if page.image %}
    <meta property="og:image" content="{{ page.image | absolute_url }}">
    <meta name="twitter:image" content="{{ page.image | absolute_url }}">
  {% elsif site.image %}
    <meta property="og:image" content="{{ site.image | absolute_url }}">
    <meta name="twitter:image" content="{{ site.image | absolute_url }}">
  {% endif %}
  {% if page.title %}
    <meta name="twitter:title" content="{{ page.title }} | {{ site.title }}">
  {% else %}
    <meta name="twitter:title" content="{{ site.title }}">
  {% endif %}
  {% if page.description %}
    <meta name="twitter:description" content="{{ page.description }}">
  {% elsif site.description %}
    <meta name="twitter:description" content="{{ site.description }}">
  {% endif %}
  <link rel="stylesheet" href="{{ '/assets/css/help.css' | relative_url }}">
  <link rel="icon" type="image/png" href="{{ '/assets/images/app-icon.png' | relative_url }}">
  <meta name="search-json-url" content="{{ '/search.json' | relative_url }}">
</head>
<body>
  <header class="help-header">
    <img src="{{ '/assets/images/app-icon.png' | relative_url }}" alt="CodeFrog" class="app-icon">
    <div class="header-title">{{ page.title | default: 'CodeFrog Help' }}</div>
    <a href="https://codefrog.app" class="back-link">‚Üê Back to CodeFrog</a>
    <div class="search-container">
      <input type="search" id="search-input" placeholder="Search help..." aria-label="Search help documentation">
      <ul id="results-container" style="display: none;"></ul>
    </div>
  </header>

  <div class="container">
    <aside class="sidebar">
      <nav class="help-nav">
        <h2>Contents</h2>
        <ul>
          {% include nav-list.html %}
        </ul>
      </nav>
    </aside>

    <main class="content">
      {{ content }}
    </main>
  </div>

  <footer>
    <p>&copy; 2025 CodeFrog. All rights reserved.</p>
    <p class="build-info">
      <small>
        Built: {{ site.time | date: "%B %d, %Y at %H:%M UTC" }}
        {% if site.github.build_revision %}
          | Commit: <a href="https://github.com/{{ site.github.repository_nwo }}/commit/{{ site.github.build_revision }}" target="_blank" rel="noopener">{{ site.github.build_revision | truncate: 7 }}</a>
        {% elsif jekyll.environment == "production" %}
          | Version: {{ site.time | date: "%Y%m%d-%H%M%S" }}
        {% endif %}
      </small>
    </p>
  </footer>

  <script src="{{ '/assets/js/lunr.min.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/lunr-search.js' | relative_url }}"></script>
  <script>
    // Handle anchor scrolling on page load
    (function() {
      function scrollToAnchor() {
        if (window.location.hash) {
          const hash = window.location.hash.substring(1);
          const element = document.getElementById(hash);
          if (element) {
            // Use setTimeout to ensure layout is complete
            setTimeout(function() {
              element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
          }
        }
      }
      
      // Try scrolling immediately if DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', scrollToAnchor);
      } else {
        scrollToAnchor();
      }
      
      // Also handle hash changes (when clicking anchor links)
      window.addEventListener('hashchange', scrollToAnchor);
    })();
    
    // Make scrollable code blocks keyboard accessible
    (function() {
      document.addEventListener('DOMContentLoaded', function() {
        // Find all scrollable pre elements
        const scrollablePres = document.querySelectorAll('pre');
        scrollablePres.forEach(function(pre) {
          // Check if element is scrollable
          if (pre.scrollWidth > pre.clientWidth || pre.scrollHeight > pre.clientHeight) {
            // Make it keyboard accessible
            if (!pre.hasAttribute('tabindex')) {
              pre.setAttribute('tabindex', '0');
            }
            // Add aria-label if missing
            if (!pre.hasAttribute('aria-label')) {
              const code = pre.querySelector('code');
              const lang = code ? code.className.match(/language-(\w+)/) : null;
              const label = lang ? 'Code block in ' + lang[1] + ' (scrollable)' : 'Scrollable code block';
              pre.setAttribute('aria-label', label);
            }
          }
        });

        // Add labels to task list checkboxes
        const taskCheckboxes = document.querySelectorAll('.task-list-item-checkbox');
        taskCheckboxes.forEach(function(checkbox) {
          if (!checkbox.hasAttribute('aria-label') && !checkbox.id) {
            // Get the text content of the parent list item
            const listItem = checkbox.closest('.task-list-item');
            if (listItem) {
              const text = listItem.textContent.trim();
              // Remove the checkbox text and clean up
              const label = text.replace(/^\s*\[[ xX]\]\s*/, '').trim();
              if (label) {
                checkbox.setAttribute('aria-label', label);
              }
            }
          }
        });
      });
    })();
  </script>
</body>
</html>

